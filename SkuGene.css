  :root{
    --bg:#0b0f17; --panel:#111827; --muted:#94a3b8; --text:#e5e7eb; --accent:#22c55e; --border:#1f2937;
    --btn:#0f1524; --btn-hover:#141c2e;
    --heat-blue:#c8f5ff; --heat-mid:#ffd08a; --heat-red:#b31212;
  }
  *{box-sizing:border-box}
  body{
    margin:0;background:var(--bg);color:var(--text);
    font:14px/1.45 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"PingFang SC","Hiragino Sans GB","Microsoft YaHei","Noto Sans CJK SC","Helvetica Neue",Arial,"Noto Sans",sans-serif;
  }
  .wrap{max-width:1280px;margin:24px auto;padding:0 16px}
  .head{display:flex;justify-content:space-between;align-items:flex-end;gap:12px;margin-bottom:12px}
  .title{display:flex;flex-direction:column;gap:6px}
  .title h2{margin:0;font-size:20px}
  .hint{font-size:12px;color:var(--muted)}
  .controls{display:grid;grid-template-columns:1.2fr .8fr;gap:12px}
  .card{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:12px}
  .toolbar{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .toolbar .group{display:flex;gap:8px;align-items:center}
  .toolbar .divider{width:1px;height:28px;background:var(--border)}
  input[type="text"], input[type="file"]{
    background:var(--btn);border:1px solid var(--border);color:var(--text);
    padding:8px 10px;border-radius:10px;outline:none;min-width:120px
  }
  input[type="range"]{ width:160px; }
  label{color:var(--muted);font-size:13px}
  button{
    background:var(--btn);color:var(--text);border:1px solid var(--border);
    border-radius:10px;padding:9px 12px;cursor:pointer;font-weight:600
  }
  button:hover{background:var(--btn-hover)}
  button.primary{background:var(--accent);color:#07240f;border-color:#0f5132}
  button.primary:hover{filter:brightness(0.98)}
  .pill{padding:6px 10px;border-radius:999px;background:#0f1524;border:1px solid var(--border);color:var(--muted)}
  #network{height:68vh;min-height:520px;border:1px dashed var(--border);border-radius:14px;background:linear-gradient(180deg,#0e1422,#0b0f17)}
  .footer{display:flex;justify-content:space-between;align-items:center;margin-top:10px}
  .stats{display:flex;gap:10px;flex-wrap:nowrap}
  .badge{background:#0f1524;border:1px solid var(--border);border-radius:999px;padding:6px 10px;color:var(--muted)}
  .progress{height:8px;background:#0f1524;border:1px solid var(--border);border-radius:999px;overflow:hidden;min-width:220px}
  .bar{height:100%;background:var(--accent);width:0%}
  .legends{display:flex;gap:16px;align-items:center;flex-wrap:nowrap}
  .legend{display:flex;align-items:center;gap:8px}
  .legend .title{font-size:12px;color:var(--muted);min-width:78px;text-align:right}
  .legend .grad{width:160px;height:10px;border-radius:6px;border:1px solid var(--border);
    background: linear-gradient(90deg,var(--heat-blue) 0%, var(--heat-mid) 55%, var(--heat-red) 100%);}
  .legend .ticks{display:flex;justify-content:space-between;font-size:12px;color:var(--muted)}
  .legend small{color:var(--muted);margin-left:6px}
  #tooltip{
    position:absolute; display:none; z-index:9999; max-width:460px; min-width:300px;
    background:#0f1524; border:1px solid var(--border); border-radius:12px; padding:0;
    box-shadow:0 6px 22px rgba(0,0,0,.35); color:var(--text); user-select:none;
  }

  #tooltip .hdr{display:flex;justify-content:space-between;align-items:center;gap:10px;background:#12192a;border-bottom:1px solid var(--border);padding:8px 10px;cursor:move;border-top-left-radius:12px;border-top-right-radius:12px}
  #tooltip h4{margin:0;font-size:14px}
  #tooltip .body{padding:10px 12px}
  #tooltip .meta{font-size:12px;color:var(--muted);margin-bottom:6px}
  #tooltip .list{max-height:260px;overflow:auto;font-size:12px;line-height:1.5;padding-right:12px;scrollbar-gutter:stable both-edges}
  #tooltip .list code{background:#0c1220;padding:2px 4px;border-radius:6px;margin-right:6px}
#tooltip .actions{display:flex;justify-content:space-between;align-items:center;gap:8px;margin:6px 0 8px;flex-wrap:nowrap}
#tooltip .actions button{border-radius:8px;padding:4px 8px;font-size:12px;cursor:pointer;border:1px solid var(--border);background:#141c2e;color:var(--text)}
#tooltip .actions button:hover{background:#19243a}
#tooltip .actions .toggle.active{background:var(--accent);color:#07240f;border-color:#0f5132}
#tooltip .list .neighbor{padding:6px 0;border-bottom:1px solid rgba(148,163,184,0.18)}
#tooltip .list .neighbor:last-child{border-bottom:none}
#tooltip .list .neighbor-line{display:grid;grid-template-columns:auto minmax(0,1fr) auto auto;align-items:center;gap:8px}

#tooltip .list .neighbor-line .name{grid-column:2;min-width:0;word-break:break-word;line-height:1.4}
#tooltip .list .score{grid-column:3;margin-left:0;font-size:12px;color:var(--muted);white-space:nowrap}
#tooltip .list .reason{margin-top:4px;font-size:12px;color:var(--muted);white-space:normal;word-break:break-word;line-height:1.45}
  #tooltip .close{background:#111827;border:1px solid var(--border);color:var(--text);border-radius:8px;padding:4px 8px;cursor:pointer;font-size:12px}

#tooltip .actions .danger{background:#b91c1c;border-color:#7f1d1d;color:#fff}
#tooltip .actions .danger:hover{background:#a31616}
#tooltip .actions .danger:disabled{opacity:0.45;cursor:not-allowed;background:#7f1d1d;border-color:#5f1414}
#tooltip .list .neighbor-line .edge-delete{grid-column:4;background:#3b1d1d;border:1px solid #7f1d1d;color:#fca5a5;border-radius:6px;padding:2px 6px;font-size:11px;cursor:pointer;white-space:nowrap}
#tooltip .list .neighbor-line .edge-delete:hover{background:#5f1b1b}

#tooltip .list::-webkit-scrollbar{width:6px}
#tooltip .list::-webkit-scrollbar-thumb{background:rgba(148,163,184,0.35);border-radius:6px}
#tooltip .list::-webkit-scrollbar-track{background:transparent}
#tooltip .list .neighbor-line code{grid-column:1;white-space:nowrap}

#tooltip .list .neighbor-line .spacer{display:none}

  .group-panel-toggle{
    position:fixed;
    top:32px;
    right:24px;
    z-index:980;
    background:var(--accent);
    color:#07240f;
    border:none;
    border-radius:999px;
    padding:9px 16px;
    font-weight:600;
    cursor:pointer;
    box-shadow:0 8px 18px rgba(34,197,94,0.28);
    transition:right .24s ease;
  }
  .group-panel-toggle:hover{filter:brightness(0.97);}
  .group-panel-toggle:active{transform:translateY(1px);}
  body.group-panel-open .group-panel-toggle{right:384px;}
  .group-panel{
    position:fixed;
    top:24px;
    right:-360px;
    width:320px;
    height:calc(100vh - 48px);
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:16px 0 0 16px;
    box-shadow:-10px 0 32px rgba(0,0,0,0.4);
    transition:right .24s ease;
    z-index:970;
    display:flex;
    flex-direction:column;
  }
  .group-panel.open{right:24px;}
  .group-panel__inner{display:flex;flex-direction:column;gap:12px;height:100%;padding:16px;}
  .group-panel__header{display:flex;justify-content:space-between;align-items:center;gap:12px;}
  .group-panel__header h3{margin:0;font-size:16px;color:var(--text);}
  .group-panel__tools{display:flex;align-items:center;gap:8px;}
  .group-panel-close{background:#111827;color:var(--muted);border:1px solid var(--border);border-radius:50%;width:28px;height:28px;font-size:14px;line-height:1;cursor:pointer;}
  .group-panel-close:hover{background:#141c2e;color:var(--text);}
  .group-list{display:flex;flex-direction:column;gap:8px;overflow-y:auto;padding-right:4px;scrollbar-gutter:stable;}
  .group-list .placeholder{padding:12px;background:#0f1524;border:1px dashed var(--border);border-radius:10px;}
  .confirmed-list .group-item{background:#111827;border-color:#1f2937;}
  .confirmed-list .group-item .tag{background:#161e2f;border-color:#243044;}
  .group-item{background:#0f1524;border:1px solid var(--border);border-radius:10px;padding:10px;display:flex;flex-direction:column;gap:6px;cursor:pointer;transition:background .15s ease,border-color .15s ease;}
  .group-item:hover{background:#141c2e;}
  .group-item .title{font-size:14px;font-weight:600;color:var(--text);}
  .group-item .meta{display:flex;justify-content:space-between;align-items:center;font-size:12px;color:var(--muted);}
  .group-item .meta .tag{padding:4px 8px;border-radius:999px;background:#111827;border:1px solid var(--border);color:var(--muted);font-size:11px;}
  .group-item.active{border-color:var(--accent);box-shadow:0 0 0 1px rgba(34,197,94,0.35);}
  .group-actions{display:flex;gap:6px;flex-wrap:wrap;}
  .group-actions button{padding:5px 10px;font-size:12px;border-radius:8px;}
  .group-actions button.confirm{background:#2563eb;border-color:#1d4ed8;color:#dbeafe;}
  .group-actions button.confirm:hover{background:#1e40af;}
  .group-actions button.undo{background:#92400e;border-color:#7c2d12;color:#fff7ed;}
  .group-actions button.undo:hover{background:#7c2d12;}

  .confirmed-panel-toggle{
    position:fixed;
    top:32px;
    left:24px;
    z-index:980;
    background:var(--accent);
    color:#07240f;
    border:none;
    border-radius:999px;
    padding:9px 16px;
    font-weight:600;
    cursor:pointer;
    box-shadow:0 8px 18px rgba(34,197,94,0.28);
    transition:left .24s ease;
  }
  .confirmed-panel-toggle:hover{filter:brightness(0.97);}
  .confirmed-panel-toggle:active{transform:translateY(1px);}
  body.confirmed-panel-open .confirmed-panel-toggle{left:384px;}
  .confirmed-panel{
    position:fixed;
    top:24px;
    left:-360px;
    width:320px;
    height:calc(100vh - 48px);
    background:var(--panel);
    border:1px solid var(--border);
    border-radius:0 16px 16px 0;
    box-shadow:10px 0 32px rgba(0,0,0,0.4);
    transition:left .24s ease;
    z-index:970;
    display:flex;
    flex-direction:column;
  }
  .confirmed-panel.open{left:24px;}
  .confirmed-panel__inner{display:flex;flex-direction:column;gap:12px;height:100%;padding:16px;}
  .confirmed-panel__header{display:flex;justify-content:space-between;align-items:center;gap:12px;}
  .confirmed-panel__header h3{margin:0;font-size:16px;color:var(--text);}
  .confirmed-panel__tools{display:flex;align-items:center;gap:8px;}
  .confirmed-panel-close{background:#111827;color:var(--muted);border:1px solid var(--border);border-radius:50%;width:28px;height:28px;font-size:14px;line-height:1;cursor:pointer;}
  .confirmed-panel-close:hover{background:#141c2e;color:var(--text);}
  .confirmed-panel__inner .group-list{flex:1;overflow-y:auto;padding-right:4px;}

  @media (max-width:1200px){
    body.group-panel-open .group-panel-toggle{right:calc(24px + min(90vw,340px));}
    .group-panel{width:min(90vw,340px);top:16px;height:calc(100vh - 32px);}
    body.confirmed-panel-open .confirmed-panel-toggle{left:calc(24px + min(90vw,340px));}
    .confirmed-panel{width:min(90vw,340px);top:16px;height:calc(100vh - 32px);}
  }
  @media (max-width:768px){
    .group-panel-toggle{top:auto;bottom:24px;right:24px;}
    body.group-panel-open .group-panel-toggle{right:calc(24px + min(90vw,340px));}
    .confirmed-panel-toggle{top:auto;bottom:24px;left:24px;}
    body.confirmed-panel-open .confirmed-panel-toggle{left:calc(24px + min(90vw,340px));}
  }

