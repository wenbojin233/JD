<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<title>同品关系可视化 · 持续扩散 + 可调展开速度</title>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<link rel="stylesheet" href="SkuGene.css"/>
</head>
<body>
  <div class="wrap">
    <div class="head">
      <div class="title">
        <h2>同品关系可视化 · 持续扩散 + 可调展开速度</h2>
        <span class="hint">默认 Sheet：<b>same_result</b> · 先选择文件，再点“构建图谱”</span>
      </div>
      <span class="pill" id="status">初始化依赖中…</span>
    </div>

    <div class="controls">
      <div class="card">
        <div class="toolbar">
          <div class="group">
            <input type="file" id="file" accept=".xlsx,.xls,.csv"/>
            <label for="sheet">Sheet</label>
            <input id="sheet" type="text" value="same_result"/>
            <button id="build" class="primary">构建图谱</button>
          </div>
          <div class="divider"></div>
          <div class="group">
            <button id="collapseAll">收起全部</button>
            <button id="explode">展开全部</button>
            <button id="pause" disabled>暂停</button>
          </div>
          <div class="divider"></div>
          <div class="group">
            <button id="reset">视图复位</button>
            <button id="export">导出 PNG</button>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="toolbar">
          <div class="group">
            <label for="search">定位节点</label>
            <input id="search" type="text" placeholder="请输入节点 ID，例如 1000001"/>
            <button id="go">定位</button>
          </div>
          <div class="divider"></div>
          <div class="group">
            <label for="minGroup">最小组件规模</label>
            <input id="minGroup" type="range" min="1" max="10" step="1" value="2"/>
            <span id="minGroupLabel" class="hint">≥ 2</span>
            <div class="divider" style="height:20px"></div>
            <label for="speed">扩散强度</label>
            <input id="speed" type="range" min="1" max="5" step="1" value="3"/>
            <span id="speedLabel" class="hint">标准</span>
            <div class="divider" style="height:20px"></div>
            <label for="renderSpeed">展开速度</label>
            <input id="renderSpeed" type="range" min="1" max="4" step="1" value="3"/>
            <span id="renderSpeedLabel" class="hint">快速</span>
          </div>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <div id="network"></div>
      <div class="footer">
        <div class="stats">
          <div class="badge" id="nodesBadge">节点数: 0</div>
          <div class="badge" id="edgesBadge">边数: 0</div>
          <div class="badge" id="compBadge">组件数: 0</div>
          <div class="badge" id="maxCompBadge">最大组件大小: 0</div>
        </div>
        <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
          <div class="legends">
            <div class="legend" title="组件规模热度（P95 封顶）">
              <span class="title">组件规模热度</span>
              <div class="grad"></div>
              <div style="width:160px">
                <div class="ticks"><span>0</span><span id="gcap">P95</span></div>
              </div>
              <small id="gmaxNote">MAX: 0</small>
            </div>
            <div class="legend" title="节点度数热度（P95 封顶）">
              <span class="title">节点度数热度</span>
              <div class="grad"></div>
              <div style="width:160px">
                <div class="ticks"><span>0</span><span id="dcap">P95</span></div>
              </div>
              <small id="dmaxNote">MAX: 0</small>
            </div>
          </div>
          <div style="display:flex;align-items:center;gap:10px">
            <div class="progress"><div class="bar" id="progBar"></div></div>
            <span class="hint" id="eta">ETA: --</span>
            <span class="hint" id="hint">准备就绪</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 浮动节点信息框 -->
  <div id="tooltip">
    <div class="hdr" id="tipDrag">
      <h4 id="tipTitle">—</h4>
      <button class="close" onclick="hideTip()">关闭</button>
    </div>
    <div class="body">
      <div class="meta" id="tipMeta"></div>
      <div class="actions" id="tipActions">
        <button id="toggleReason" class="toggle">显示同品原因</button>
      </div>
      <div class="list" id="tipList"></div>
    </div>
  </div>

<script src="SkuGene.js"></script>
</body>
</html>
